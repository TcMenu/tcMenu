<TcMenuPlugin name="Menu In Menu connection over Ethernet/WiFi" id="5DA97BEA-2CA5-44EE-96C2-28E652A18D3A" subsystem="REMOTE"
              requiresDesigner="2.2.0" xmlns="https://www.thecoderscorner.com/libraries/tcmenuPluginItem" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              xsi:schemaLocation="https://www.thecoderscorner.com/libraries/tcmenuPluginItem https://www.thecoderscorner.com/libraries/tcmenu-plugin-item.xsd">
    <SupportedPlatforms>
        <Platform>RASPBERRY_PIJ</Platform>
    </SupportedPlatforms>
    <Description>Use this option to create a network socket connection from another device to your embedded Java application on Raspberry PI/embedded Linux. The menu is nested under an existing submenu.</Description>
    <Documentation link="https://www.thecoderscorner.com/products/arduino-libraries/tc-menu/tcmenu-iot/java-menu-in-menu/"/>
    <RequiredLibraries/>
    <ImageFile>menu-in-menu.png</ImageFile>

    <Properties>
        <Property id="MIM_REPLICATION_MODE" name="Structural and connectivity changes" desc="How structural and connectivity changes are shown" initial="REPLICATE_ADD_STATUS_ITEM" type="choice">
            <Choices>
                <Choice desc="Notify changes and add a status item">REPLICATE_ADD_STATUS_ITEM</Choice>
                <Choice desc="Notify changes">REPLICATE_NOTIFY</Choice>
                <Choice desc="Do not notify at all">REPLICATE_SILENTLY</Choice>
            </Choices>
        </Property>
        <Property id="MIM_SUB_ROOT" name="Submenu where these items appear" initial="-1" desc="Choose a submenu for items to be stored underneath" type="SubMenuItem"  />
        <Property id="MIM_VARIABLE_NAME" name="The name of the variable" initial="menuInMenu" desc="The name of the variable to create for this menu" type="variable" />
        <Property id="MIM_HOSTNAME" name="The host/IP of the device" initial="127.0.0.1" desc="The host or IP address of the device" type="text"/>
        <Property id="MIM_PORTNUM" name="Port number the device listens on" initial="3333" desc="Port on which device listens for connections"
                  type="int" min="0" max="65535"  />
        <Property id="MIM_START_OFFSET" name="ID offset start" initial="100000" desc="The offset is applied to all IDs from the remote menu"
                  type="int" min="100000" max="10000000"  />
        <Property id="MIM_MAX_RANGE" name="The maximum range of IDs in this menu" initial="70000" desc="The maximum range of IDs in the remote menu"
                  type="int" min="32000" max="99000"  />
    </Properties>

    <ApplicabilityDefs/>

    <SourceFiles>
    </SourceFiles>

    <IncludeFiles>
        <Header name="java.time.Clock" inSource="true"/>
        <Header name="java.util.UUID" inSource="true"/>
        <Header name="java.util.concurrent.ScheduledExecutorService" inSource="true"/>
        <Header name="com.thecoderscorner.menu.auth.MenuAuthenticator" inSource="true"/>
        <Header name="com.thecoderscorner.menu.domain.state.MenuTree" inSource="true"/>
        <Header name="com.thecoderscorner.menu.mgr.*" inSource="true"/>
        <Header name="com.thecoderscorner.menu.remote.*" inSource="true"/>
        <Header name="com.thecoderscorner.menu.remote.protocol.TagValMenuCommandProtocol" inSource="true"/>
        <Header name="com.thecoderscorner.menu.remote.socket.SocketBasedConnector" inSource="true"/>
    </IncludeFiles>

    <GlobalVariables>
        <Variable export="true" inContext="true" name="tagVal" type="TagValMenuCommandProtocol" />

        <Variable export="true" inContext="true" name="${MIM_VARIABLE_NAME}Connector" type="SocketBasedConnector">
            <Param value="new LocalIdentifier(UUID.fromString(&quot;${APP_UUID}&quot;), &quot;${APP_NAME}&quot;)" />
            <Param ref="ScheduledExecutorService" name="executor" />
            <Param value="Clock.systemUTC()" />
            <Param ref="MenuCommandProtocol" name="tagVal" />
            <Param value="&quot;${MIM_HOSTNAME}&quot;"/>
            <Param value="${MIM_PORTNUM}"/>
            <Param value="ConnectMode.FULLY_AUTHENTICATED"/>
        </Variable>

        <Variable export="true" inContext="true" name="${MIM_VARIABLE_NAME}" type="MenuInMenu">
            <Param value="${MIM_VARIABLE_NAME}Connector" />
            <Param ref="MenuManagerServer" name="managerServer" />
            <Param value="${MIM_SUB_ROOT}" />
            <Param value="MenuInMenu.ReplicationMode.${MIM_REPLICATION_MODE}"/>
            <Param value="${MIM_START_OFFSET}"/>
            <Param value="${MIM_MAX_RANGE}"/>
        </Variable>
    </GlobalVariables>

    <SetupFunctions>
        <Function name="start" object="&quot;${MIM_VARIABLE_NAME}&quot;" pointer="true" />
    </SetupFunctions>
</TcMenuPlugin>